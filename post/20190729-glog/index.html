<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  
  <meta name="author" content="codedump">

  
  
  <meta name="description" content="glog C&#43;&#43;ç‰ˆæœ¬ä»£ç åˆ†æ">
  

  
  <link rel="icon" href="https://www.codedump.info/favicon.ico">

  
  
  <meta name="keywords" content=" glog  ç½‘ç»œç¼–ç¨‹ ">
  

  
  

  
  <meta property="og:title" content="glog C&#43;&#43;ç‰ˆæœ¬ä»£ç åˆ†æ" />
<meta property="og:description" content="glog C&#43;&#43;ç‰ˆæœ¬ä»£ç åˆ†æ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.codedump.info/post/20190729-glog/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2019-07-29T11:43:56+08:00" />
<meta property="article:modified_time" content="2019-07-29T11:43:56+08:00" />



  
  <link rel="canonical" href="https://www.codedump.info/post/20190729-glog/">

  
  
  <meta itemprop="name" content="glog C&#43;&#43;ç‰ˆæœ¬ä»£ç åˆ†æ">
<meta itemprop="description" content="glog C&#43;&#43;ç‰ˆæœ¬ä»£ç åˆ†æ"><meta itemprop="datePublished" content="2019-07-29T11:43:56+08:00" />
<meta itemprop="dateModified" content="2019-07-29T11:43:56+08:00" />
<meta itemprop="wordCount" content="2638">
<meta itemprop="keywords" content="ç½‘ç»œç¼–ç¨‹," />

  
  <link media="screen" rel="stylesheet" href='https://www.codedump.info/css/common.css'>
  <link media="screen" rel="stylesheet" href='https://www.codedump.info/css/content.css'>

  
  
  <title>glog C&#43;&#43;ç‰ˆæœ¬ä»£ç åˆ†æ - codedumpçš„ç½‘ç»œæ—¥å¿—</title>
  

  
  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="glog C&#43;&#43;ç‰ˆæœ¬ä»£ç åˆ†æ"/>
<meta name="twitter:description" content="glog C&#43;&#43;ç‰ˆæœ¬ä»£ç åˆ†æ"/>


  
<link rel="stylesheet" href='https://www.codedump.info/css/single.css'>

</head>

<body>
  <div id="wrapper">
    <header id="header">
  <h1>
    <a href="https://www.codedump.info">codedumpçš„ç½‘ç»œæ—¥å¿—</a>
  </h1>

  <nav>
    
    <span class="nav-bar-item">
      <a class="link" href="/">ä¸»é¡µ</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/post/">å½’æ¡£</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/tags/">æ ‡ç­¾</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/categories/">åˆ†ç±»</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/post/20200122-series-pages/">ç³»åˆ—æ–‡ç« ç´¢å¼•</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/page/weekly">å‘¨åˆŠ</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="https://www.codedump.info/index.xml">è®¢é˜…</a>
    </span>
    
    <span class="nav-bar-item">
      <a class="link" href="/page/about">å…³äº</a>
    </span>
    
  </nav>
</header>

    
<main id="main" class="post">
  
  
  <h1>glog C&#43;&#43;ç‰ˆæœ¬ä»£ç åˆ†æ</h1>
  
  <div>
    <b>Keywords: </b>
    
    <a class="link" href='https://www.codedump.info/tags/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B'>#ç½‘ç»œç¼–ç¨‹</a>
    
  </div>
  
  
  <article class="content">
    
    <p>æœ¬æ–‡åŸºäºglog CPPç‰ˆæœ¬çš„0.4.0ç‰ˆæœ¬ï¼Œå¯¹glogçš„å®ç°æœºåˆ¶åšä¸€äº›ç®€å•çš„åˆ†æè®°å½•ã€‚</p>
<h1 id="æ¦‚è¿°">æ¦‚è¿°</h1>
<p>è¦è®°å½•ä¸€æ¡æ—¥å¿—ï¼Œåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li>é¦–å…ˆç”Ÿæˆæ—¥å¿—ã€‚</li>
<li>ç„¶åå°†æ—¥å¿—å†…å®¹è¾“å‡ºåˆ°ç›¸åº”çš„è®¾å¤‡ï¼Œå¦‚æ ‡å‡†è¾“å‡ºã€æ–‡ä»¶ç­‰ã€‚</li>
</ul>
<p>ä»¥ä¸‹å°±åˆ†ä¸¤éƒ¨åˆ†å±•å¼€å¯¹glogçš„åˆ†æã€‚</p>
<h1 id="æ—¥å¿—çš„ç”Ÿæˆ">æ—¥å¿—çš„ç”Ÿæˆ</h1>
<p>ä¸€èˆ¬æœ‰ä¸¤ç§ç”Ÿæˆæ—¥å¿—æ•°æ®çš„æ–¹å¼ï¼š</p>
<ul>
<li>ç±»printfçš„æ–¹å¼ï¼Œå°†éœ€è¦è¾“å…¥çš„æ•°æ®æ ¼å¼åŒ–ã€‚</li>
<li>ç±»C++ streamæµçš„æ–¹å¼ï¼Œæä¾›å‡ºæ¥operator &laquo;æ“ä½œç¬¦ä¾›è¾“å…¥æ•°æ®ã€‚</li>
</ul>
<p>å‰è€…çš„å¥½å¤„åœ¨äºå¯ä»¥å¯¹è¾“å…¥çš„æ•°æ®æ ¼å¼è¿›è¡Œä¸¥æ ¼æ£€æŸ¥ï¼Œä¸åŒ¹é…çš„æƒ…å†µä¸‹ç¼–è¯‘å™¨ä¼šè¿›è¡Œå‘Šè­¦ã€‚ç¼ºç‚¹åˆ™æ˜¯ä¸å¤Ÿçµæ´»ã€‚
åè€…çš„å¥½å¤„æ˜¯çµæ´»ï¼Œé™¤äº†ç”¨äº†è¿›è¡Œä¸€èˆ¬çš„æ—¥å¿—è¾“å…¥ï¼Œè¿˜å¯ä»¥å†™å‡ºç±»ä¼¼</p>
<pre tabindex="0"><code>CHECK_IF(æŸæ¡ä»¶ä¸æˆç«‹) &lt;&lt; è¾“å‡ºæ—¥å¿—
</code></pre><p>çš„æ“ä½œã€‚</p>
<p>glogä¸­é€‰æ‹©äº†ç¬¬äºŒç§æ–¹å¼ã€‚</p>
<p>é¦–å…ˆæ¥çœ‹glogå¯¹å¤–æš´éœ²çš„ç”¨äºæ—¥å¿—è¾“å…¥çš„æ¥å£ã€‚å…¶å¯¹åº”çš„å®æ˜¯ï¼š</p>
<pre tabindex="0"><code>#define LOG(severity) COMPACT_GOOGLE_LOG_ ## severity.stream()

#define COMPACT_GOOGLE_LOG_INFO google::LogMessage( \
    __FILE__, __LINE__)
#define COMPACT_GOOGLE_LOG_WARNING google::LogMessage( \
    __FILE__, __LINE__, google::GLOG_WARNING)
</code></pre><p>ä»ä¸­å¯ä»¥çœ‹åˆ°glogä¸­æ¯ä¸€æ¡æ—¥å¿—ï¼Œéƒ½å¯¹åº”ä¸€ä¸ªLogMessageçš„ç±»ï¼Œç„¶åå°†è¿”å›å…¶ä¸­çš„stream()å¯¹è±¡è¾“å…¥æ—¥å¿—æ•°æ®ã€‚</p>
<p>æ¯ä¸ªLogMessageå†…éƒ¨æœ‰ä¸€ä¸ªåä¸ºLogMessageDataçš„æˆå‘˜ï¼Œç”¨äºä¿å­˜è¿™äº›æ•°æ®ï¼Œå…¶ä¸­æ¯”è¾ƒé‡è¦çš„æˆå‘˜æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p>
<pre tabindex="0"><code>char message_text_[LogMessage::kMaxLogMessageLen+1]; // ç”¨æˆ·å­˜å‚¨æ—¥å¿—çš„å›ºå®šé•¿åº¦æ•°ç»„ï¼Œå¤§å°ä¸º30KBã€‚
LogStream stream_; // ç”¨äºæ¥æ”¶ç”¨æˆ·æ—¥å¿—çš„C++streamï¼Œæ„é€ æ—¶ä¼ å…¥ä¸Šé¢çš„message_text_æ¥æ„é€ ï¼Œæ‰€ä»¥å®é™…å†™æ•°æ®ä¼šåˆ°message_text_ä¸­ã€‚
void (LogMessage::*send_method_)(); // ç”¨æˆ·æœ€ç»ˆå‘é€æ—¥å¿—æ•°æ®çš„å‡½æ•°æŒ‡é’ˆã€‚
timestamp_ã€tm_time_ï¼šä¿å­˜æ—¥å¿—æ—¶é—´ç›¸å…³çš„æˆå‘˜ã€‚
</code></pre><p>å®é™…æ ¹æ®æ—¥å¿—åˆ›å»ºå‡ºä¸€ä¸ªLogMessageå¯¹è±¡æ—¶ï¼Œä¼šæ ¹æ®ä¸åŒç±»å‹çš„æ—¥å¿—ï¼Œä¼ å…¥ä¸åŒçš„send_methodå‡½æ•°æŒ‡é’ˆï¼Œè€Œæ¯ä¸ªä¸åŒçš„LogMessageæ„é€ æ—¶éƒ½ä¼šå»è°ƒç”¨å…¶å†…éƒ¨çš„Initå‡½æ•°å®ŒæˆLogMessageDataçš„æ„é€ ï¼ŒInitå‡½æ•°ä¸»è¦åšçš„äº‹æƒ…æœ‰ï¼š</p>
<ul>
<li>å­˜å‚¨send_methodå‡½æ•°æŒ‡é’ˆã€‚</li>
<li>è·å–å½“å‰çš„ç³»ç»Ÿæ—¶é—´ï¼Œå­˜æ”¾åˆ°ç›¸åº”çš„æˆå‘˜ä¸­ã€‚</li>
</ul>
<p>è€ŒLOGä¹‹ç±»çš„å®ï¼Œå®é™…è¿”å›çš„å°±æ˜¯LogMessageDataçš„streamæŒ‡é’ˆï¼Œå¾…åˆ°ä¸€åˆ‡çš„è¾“å…¥å®Œæ¯•ï¼Œè¿™ä¸€æ¡æ—¥å¿—å¯¹åº”çš„LogMessageå°±ä¼šè¢«ææ„ï¼Œå…¶ææ„å‡½æ•°å†…åˆä¼šè°ƒç”¨æˆå‘˜å‡½æ•°Flushï¼Œè¿™ä¸ªå‡½æ•°æœ€ç»ˆå®Œæˆå°†æ—¥å¿—è¾“å‡ºçš„æ“ä½œï¼š</p>
<pre tabindex="0"><code>void LogMessage::Flush() {
  // ...
  {
    MutexLock l(&amp;log_mutex);
    (this-&gt;*(data_-&gt;send_method_))();
    ++num_messages_[static_cast&lt;int&gt;(data_-&gt;severity_)];
  }
  // ...
}
</code></pre><p>æœ‰äº†ä»¥ä¸Šçš„å‡†å¤‡ï¼Œå®é™…å›å¤´æ¥çœ‹ä¸€ä¸ªæ—¥å¿—çš„è¾“å…¥</p>
<p><img src="/media/imgs/20190729-glog/log-generate.png" alt="log-generate" title="log-generate"></p>
<h1 id="è¾“å‡ºæ—¥å¿—">è¾“å‡ºæ—¥å¿—</h1>
<p>ä»¥ä¸Šè§£å†³äº†ç”Ÿæˆæ—¥å¿—çš„é—®é¢˜ï¼Œç»§ç»­å¾€ä¸‹çœ‹ç”Ÿæˆæ—¥å¿—ä¹‹åå‘åˆ°å“ªé‡Œå»ã€‚</p>
<p>æ—¥å¿—çš„åˆ†å‘ç”±ç±»LogDestinationæ¥è´Ÿè´£ï¼Œå…¶æä¾›å‡ºå»çš„æ¥å£å¤šä¸ºé™æ€å‡½æ•°ã€‚ ä»¥æŸä¸ªsend_methodå‡½æ•°çš„å®ç°æ¥çœ‹ï¼Œå¦‚LogMessage::SendToLogï¼Œçœç•¥å¤§éƒ¨åˆ†ç»†èŠ‚ï¼Œå…¶å†…éƒ¨å®ç°ä¸ºï¼š</p>
<pre tabindex="0"><code>void LogMessage::SendToLog() EXCLUSIVE_LOCKS_REQUIRED(log_mutex) {
    // ...

    // log this message to all log files of severity &lt;= severity_
    LogDestination::LogToAllLogfiles(data_-&gt;severity_, data_-&gt;timestamp_,
                                     data_-&gt;message_text_,
                                     data_-&gt;num_chars_to_log_);
    LogDestination::LogToSinks(data_-&gt;severity_,
                           data_-&gt;fullname_, data_-&gt;basename_,
                           data_-&gt;line_, &amp;data_-&gt;tm_time_,
                           data_-&gt;message_text_ + data_-&gt;num_prefix_chars_,
                           (data_-&gt;num_chars_to_log_
                            - data_-&gt;num_prefix_chars_ - 1));
    // ...
}
</code></pre><p>å…¶ä¸­ï¼š</p>
<ul>
<li>LogDestination::LogToAllLogfilesï¼šå†™æ—¥å¿—åˆ°å¯¹åº”çº§åˆ«çš„æ—¥å¿—æ–‡ä»¶ä¸­ã€‚</li>
<li>LogDestination::LogToSinksï¼šå†™åˆ°ç”¨æˆ·è‡ªå®šä¹‰çš„sinkè¾“å‡ºä¸­ï¼Œä¼ é€’é‚£ä¹ˆå¤šå‚æ•°æ˜¯ä¸ºäº†å»æ‰æ·»åŠ è¿›å»çš„logprefixï¼ŒåŒ…æ‹¬severityï¼Œtsï¼Œçº¿ç¨‹idï¼Œæ–‡ä»¶basenameç­‰ã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥åˆ†åˆ«åˆ†æè¿™ä¸¤éƒ¨åˆ†è¾“å‡ºçš„æ“ä½œã€‚</p>
<h2 id="å†™åˆ°å¯¹åº”çº§åˆ«çš„æ—¥å¿—ä¸­">å†™åˆ°å¯¹åº”çº§åˆ«çš„æ—¥å¿—ä¸­</h2>
<p>LogDestinationå†…éƒ¨æœ‰ä¸€ä¸ªä¸ä¸åŒæ—¥å¿—çº§åˆ«ç›¸å…³çš„LogDestinationæ•°ç»„ï¼š</p>
<pre tabindex="0"><code>static LogDestination* log_destinations_[NUM_SEVERITIES];
</code></pre><p>é¦–å…ˆæ¥çœ‹LogToAllLogfileså‡½æ•°çš„å®ç°ï¼š</p>
<pre tabindex="0"><code>inline void LogDestination::LogToAllLogfiles(LogSeverity severity,
                                             time_t timestamp,
                                             const char* message,
                                             size_t len) {

  if ( FLAGS_logtostderr ) {           // global flag: never log to file
    ColoredWriteToStderr(severity, message, len);
  } else {
    for (int i = severity; i &gt;= 0; --i)
      LogDestination::MaybeLogToLogfile(i, timestamp, message, len);
  }
}
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹æŸä¸ªçº§åˆ«çš„æ—¥å¿—è€Œè¨€ï¼Œä¼šä¾æ¬¡è°ƒç”¨çº§åˆ«å€¼æ›´å°çš„æ—¥å¿—è¾“å‡ºï¼Œæ¯”å¦‚WARNçº§åˆ«çš„æ—¥å¿—ä¹Ÿä¼šè¾“å‡ºåˆ°INFOçº§åˆ«çš„æ—¥å¿—æ–‡ä»¶ä¸­ã€‚</p>
<p>æ¥ç€çœ‹MaybeLogToLogfileå‡½æ•°çš„å®ç°ï¼š</p>
<pre tabindex="0"><code>inline void LogDestination::MaybeLogToLogfile(LogSeverity severity,
                                              time_t timestamp,
					      const char* message,
					      size_t len) {
  const bool should_flush = severity &gt; FLAGS_logbuflevel;
  LogDestination* destination = log_destination(severity);
  destination-&gt;logger_-&gt;Write(should_flush, timestamp, message, len);
}

inline LogDestination* LogDestination::log_destination(LogSeverity severity) {
  assert(severity &gt;=0 &amp;&amp; severity &lt; NUM_SEVERITIES);
  if (!log_destinations_[severity]) {
    log_destinations_[severity] = new LogDestination(severity, NULL);
  }
  return log_destinations_[severity];
}
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li>é¦–å…ˆä¼šä»log_destinationä¸­æ ¹æ®æ—¥å¿—çº§åˆ«ï¼Œå¾—åˆ°å¯¹åº”çš„log_destinations_æ•°ç»„æˆå‘˜è¿”å›ã€‚</li>
<li>ç„¶åè°ƒç”¨destination-&gt;logger_æˆå‘˜çš„Writeå‡½æ•°å†™æ—¥å¿—ï¼Œå…¶ä¸­ä¼šä¼ å…¥ä¸€ä¸ªå«should_flushçš„å‚æ•°ï¼Œä»…åœ¨ä¼ å…¥çš„æ—¥å¿—çº§åˆ«å¤§äºFLAGS_logbuflevelæ‰ä¼šä¸ºçœŸï¼Œè¿™æ ·å¯ä»¥æ§åˆ¶ä¸åŒçº§åˆ«æ—¥å¿—çš„flushåˆ°ç£ç›˜çš„è¡Œä¸ºã€‚</li>
</ul>
<p>è€Œlogger_æˆå‘˜æ˜¯ä¸€ä¸ªLoggeræ¥å£ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªçº¯è™šç±»ï¼Œå› æ­¤glogä¹Ÿæä¾›äº†æ¥å£ç»™ç”¨æˆ·å®šåˆ¶ä¸åŒçº§åˆ«æ—¥å¿—å¯¹åº”çš„Loggerç±»ï¼š</p>
<pre tabindex="0"><code>// Set the logger for the specified severity level.  The logger
// becomes the property of the logging module and should not
// be deleted by the caller.  Thread-safe.
extern GOOGLE_GLOG_DLL_DECL void SetLogger(LogSeverity level, Logger* logger);
</code></pre><h2 id="å†™åˆ°ç”¨æˆ·è‡ªå®šä¹‰sinkä¸­">å†™åˆ°ç”¨æˆ·è‡ªå®šä¹‰sinkä¸­</h2>
<p>æ¥ä¸‹æ¥çœ‹çœ‹æ€ä¹ˆå°†æ—¥å¿—è¾“å‡ºåˆ°ç”¨æˆ·è‡ªå®šä¹‰sinkä¸­çš„æµç¨‹ã€‚</p>
<p>è€Œæ¯ä¸ªLogDestinationå†…éƒ¨åˆæœ‰ä¸€ä¸ªå«LogSinkçš„ç±»æ¥çœŸæ­£è´Ÿè´£æ—¥å¿—çš„è¾“å‡ºï¼Œè¯¥ç±»ä¹Ÿæ˜¯ä¸€ä¸ªçº¯è™šç±»ï¼Œç”¨æˆ·éœ€è¦å®ç°å…¶ä¸­çš„sendæ–¹æ³•æ¥å®Œæˆæ—¥å¿—çš„è¾“å‡ºã€‚å¯¹äºæ¯ä¸ªçº§åˆ«çš„æ—¥å¿—è€Œè¨€ï¼Œä¼šå°†åŒçº§åˆ«çš„LogSinkä¸€èµ·æ”¾åœ¨ä¸€ä¸ªå‘é‡ä¸­ï¼š</p>
<pre tabindex="0"><code>static vector&lt;LogSink*&gt;* sinks_
</code></pre><p>å› æ­¤ï¼Œå½“éœ€è¦è¾“å‡ºè‡ªå®šä¹‰çš„æ—¥å¿—æ—¶ï¼Œå°±éå†è¯¥å‘é‡è¿›è¡Œè°ƒç”¨ï¼š</p>
<pre tabindex="0"><code>inline void LogDestination::LogToSinks(LogSeverity severity,
                                       const char *full_filename,
                                       const char *base_filename,
                                       int line,
                                       const struct ::tm* tm_time,
                                       const char* message,
                                       size_t message_len) {
  ReaderMutexLock l(&amp;sink_mutex_);
  if (sinks_) {
    for (int i = sinks_-&gt;size() - 1; i &gt;= 0; i--) {
      (*sinks_)[i]-&gt;send(severity, full_filename, base_filename,
                         line, tm_time, message, message_len);
    }
  }
}
</code></pre><p><img src="/media/imgs/20190729-glog/log-output.png" alt="log-output" title="log-output"></p>
<h1 id="æ€§èƒ½åˆ†æ">æ€§èƒ½åˆ†æ</h1>
<p>å†™äº†ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç¨‹åºï¼Œèµ·å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¸€èµ·ä½¿ç”¨glogå†™å…¥æ—¥å¿—ï¼Œç”¨ç«ç„°å›¾åˆ†åˆ«åˆ†æå®ƒçš„onå’Œoff CPUæ¶ˆè€—å¦‚ä¸‹ï¼š</p>
<p>on CPUï¼š</p>
<p><img src="/media/imgs/20190729-glog/on.svg" alt="on" title="on"></p>
<p>off CPUï¼š</p>
<p><img src="/media/imgs/20190729-glog/off.svg" alt="off" title="off"></p>
<p>ä»ä¸Šé¢çš„ç«ç„°å›¾å¯ä»¥çœ‹åˆ°å‡ ä¸ªä¼˜åŒ–ç‚¹ã€‚</p>
<h2 id="localtime_rçš„è°ƒç”¨">localtime_rçš„è°ƒç”¨</h2>
<p>åœ¨å‰é¢åˆ†æåˆ°çš„LogMessage::Initå‡½æ•°ä¸­ï¼Œä¼šè°ƒç”¨localtime_rå‡½æ•°è·å¾—å½“å‰æ—¶åŒºçš„æ—¶é—´ï¼Œä½†æ˜¯è¯¥å‡½æ•°æœ‰å‡ ä¸ªå¤§é—®é¢˜ï¼š</p>
<ul>
<li>æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªä¼ å…¥å½“å‰ç§’æ•°ï¼Œç„¶åæ ¹æ®æ—¶åŒºå°†è¿™ä¸ªç§’æ•°è½¬æ¢æˆæ—¶åŒºæ‰€åœ¨åœ°æ—¶é—´çš„å‡½æ•°ï¼Œç„¶è€Œç”±äºéœ€è¦åŠ é”è·å–æ—¶åŒºï¼Œæ‰€ä»¥æ¯æ¬¡è°ƒç”¨è¯¥å‡½æ•°glibcå†…éƒ¨çš„å®ç°éƒ½éœ€è¦åŠ é”æ“ä½œï¼Œè¡¨ç°åœ¨off CPUçš„ç«ç„°å›¾ä¸­ï¼Œå°±æ˜¯__tz_convertè¿™ä¸ªå‡½æ•°çš„è°ƒç”¨ã€‚</li>
<li>ç”±äºåŠ é”ï¼Œå¯¼è‡´è¿™ä¸ªå‡½æ•°å¦‚æœè¢«ä¿¡å·ä¸­æ–­ç„¶ååˆåœ¨ä¿¡å·å¤„ç†ä¸­ç»§ç»­è¢«è°ƒç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ­»é”ç°è±¡ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œä¼˜åŒ–çš„æ–¹å¼æ˜¯è‡ªå·±å®ç°ä¸€ä¸ªå®Œæˆç›¸åŒåŠŸèƒ½çš„å‡½æ•°ï¼Œè€Œåœ¨ä¼ å…¥å‚æ•°ä¸­éœ€è¦æä¾›æ—¶åŒºå€¼ï¼Œè¿™æ ·å°±å˜æˆäº†ä¸€ä¸ªçº¯CPUè‚Œé…¸è€Œä¸éœ€è¦åŠ é”çš„æ“ä½œã€‚æˆ‘å•ç‹¬æŠŠlocaltimeå’Œä¼˜åŒ–ç‰ˆæœ¬æ‹¿å‡ºæ¥å¯¹æ¯”å‹æµ‹ï¼Œèƒ½æœ‰å¾ˆå¤§çš„æå‡ã€‚</p>
<p>å‚è€ƒï¼š</p>
<ul>
<li><a href="https://www.bugwz.com/2019/01/12/localtime/">localtimeå‡½æ•°æ­»é”åˆ†æ</a></li>
</ul>
<h2 id="å‡å°‘å…¨å±€é”">å‡å°‘å…¨å±€é”</h2>
<p>å‰é¢åˆ†æåˆ°ï¼Œåœ¨è°ƒç”¨send_methodä¹‹å‰éœ€è¦å…¨å±€åŠ é”ï¼Œä»ç«ç„°å›¾åˆ†ææ¥çœ‹ï¼Œç¡®å®ä¹Ÿåœ¨è¿™é‡Œè€—è´¹äº†ç›¸å½“çš„æ—¶é—´ã€‚</p>
<p>æœ‰äº›äººæå‡ºäº†ä¸€ç§å¼‚æ­¥æ—¥å¿—æ•°æ®çš„æ–¹å¼ï¼Œå³ç‹¬ç«‹å‡ºæ¥ä¸€ä¸ªæ—¥å¿—çº¿ç¨‹ï¼Œå°†æ—¥å¿—éƒ½å‘å¾€è¿™ä¸ªçº¿ç¨‹é‡Œé¢ï¼Œè€Œå‘é€çš„æµç¨‹å¯ä»¥ä½¿ç”¨æ— é”é˜Ÿåˆ—ç­‰æœºåˆ¶å‡å°‘é”çš„æ¶ˆè€—ï¼Œè§
<a href="https://www.slideshare.net/chenshuo/efficient-logging-in-multithreaded-c-server">Efficient logging in multithreaded C++ server</a></p>

    
  </article>
  <div class="paginator">
    
    <a class="link" href="https://www.codedump.info/post/20190629-service-history/">â† prev</a>
    
    
    <a class="link" href="https://www.codedump.info/post/20190818-im-msg-gate/">next â†’</a>
    
  </div>

    
<h1>ç›¸å…³æ–‡ç« </h1>
<li><strong> 5119-11-05: </strong> <a href="https://www.codedump.info/post/20201105-kcp/">KCP 1.4æºç åˆ†æ</a>  </li><li><strong> 13049-04-13: </strong> <a href="https://www.codedump.info/post/20190413-problem-fix/">çº¿ä¸Šå­˜å‚¨æœåŠ¡å´©æºƒé—®é¢˜åˆ†æè®°å½•</a>  </li><li><strong> 27029-02-27: </strong> <a href="https://www.codedump.info/post/20190227-tcp/">TCPåè®®ç¬”è®°</a>  </li><li><strong> 9029-02-09: </strong> <a href="https://www.codedump.info/post/20190209-zeromq-lockfree-queue/">zeromqæ‰€è°“çš„â€œæ— é”æ¶ˆæ¯é˜Ÿåˆ—â€</a>  </li><li><strong> 23019-01-23: </strong> <a href="https://www.codedump.info/post/20190123-libuv/">Libuvä»£ç ç®€å•åˆ†æ</a>  </li>
<h1>é‚®ä»¶è®¢é˜…</h1>

<div class="custom-footer">
  <form action="https://www.getrevue.co/profile/lichuang/add_subscriber" method="post" id="revue-form" name="revue-form"  target="_blank" align="center">
    <input class="newsletter-email-field" placeholder="é‚®ä»¶è®¢é˜…æœ¬ç«™æ›´æ–°" type="email" name="member[email]" size="26">
    <input class="newsletter-submit-button" type="submit" value="ç‚¹å‡»è®¢é˜…" name="member[subscribe]">
    <div class="revue-form-footer">By subscribing, you agree with Revueâ€™s <a target="_blank" href="https://www.getrevue.co/terms">Terms of Service</a> and <a target="_blank" href="https://www.getrevue.co/privacy">Privacy Policy</a>.</div>
  </form>
</div>

<img align="center" src="https://www.codedump.info/media/imgs/reward/qrcode.png" alt="wechat-account-qrcode">
    <footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">ç½‘ç»œç¼–ç¨‹</a>
          </div><div class="comment">
    
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "lichuang-codedump" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
    
    

        <script src="https://utteranc.es/client.js"
            repo="{{ .Site.Params.utterances.owner }}/{{ .Site.Params.utterances.repo }}"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
  

  </div>

  <main id="main" class="main">
    <div class="content-wrapper">
      <div id="content" class="content">
        
      </div>
      <div id="disqus_thread"></div>
    <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'lichuang-codedump';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  

  
    <script src="https://utteranc.es/client.js"
            repo="lichuang/lichuang.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

    </div>
  </main>


  
</main>

    <footer id="footer">
  <div>
    <span>Â© 2019</span> - <span>2022</span>
  </div>

  <div>
    <span>Powered by </span>
    <a class="link" href="https://gohugo.io/">Hugo</a>
    <span> ğŸ¦ Theme </span>
    <a class="link" href="https://github.com/queensferryme/hugo-theme-texify">TeXify</a>
  </div>

  <div class="footnote">
    <span>Follow me on <a class=link href=https://github.com/lichuang>GitHub</a>,
<a class=link href=https://twitter.com/lichuang>Twitter</a> or
<a class=link href=/index.xml>RSS</a> |
<a class=link href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener>CC BY-NC-SA 4.0</a>
</span>
  </div>
</footer>

  </div>

  
  



  
  

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-126255685-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</body>

</html>
